import { handleActions } from "redux-actions";

import { updateProductFail, updateProductRequest } from "../actions";
import { CartState } from "../types";

const initialState: CartState = {};

export default handleActions(
  {
    // @ts-ignore
    [updateProductRequest]: (
      state: CartState,
      { payload }: { payload: { id: string; delta: number } }
    ) => ({
      ...state,
      [payload.id]: state[payload.id]
        ? state[payload.id] + payload.delta * -1
        : payload.delta * -1,
    }),
    // @ts-ignore
    [updateProductFail]: (
      state: CartState,
      { payload }: { payload: { id: string; delta: number } }
    ) => ({
      ...state,
      [payload.id]: state[payload.id] - payload.delta * -1,
    }),
  },
  initialState
);
