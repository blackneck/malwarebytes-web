import React, { useEffect } from "react";
import { useCookies } from "react-cookie";
import { useSelector } from "react-redux";
import { v4 } from "uuid";

import { cartIdCookie } from "../constants";
import { getUpdatedProduct } from "../selectors";
import CartUpdatedModal from "./CartUpdatedModalContainer";

const CartContainer = () => {
  const updatedProduct = useSelector(getUpdatedProduct);

  const [cookies, setCookie] = useCookies([cartIdCookie]);

  useEffect(() => {
    const currentCartId = cookies[cartIdCookie];
    if (!currentCartId) {
      setCookie(cartIdCookie, v4());
    }
  }, [cookies, setCookie]);

  return updatedProduct && updatedProduct.delta !== 0 ? (
    <CartUpdatedModal updatedProduct={updatedProduct} />
  ) : null;
};

export default CartContainer;
